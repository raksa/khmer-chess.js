!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(){return(()=>{"use strict";var e={463:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(147)),o=n(749),u=r(n(141)),a=r(n(870)),s=r(n(984)),c=function(){function e(e){var t=s.default.fromString(e);this.kpgn=new u.default(t)}return e.prototype.loadKpng=function(e){this.kpgn.fromJson(e)},e.prototype.resetBoard=function(){this.kpgn.ren=s.default.fromString()},e.prototype.getCanMoves=function(){return this.kpgn.ren.genAllCanMoves()},e.prototype.getCanMovePointsByPoint=function(e){return this.kpgn.ren.getCanMovePointsByPoint(e)},e.prototype.validateRENStr=function(e){try{return s.default.fromString(e),{valid:!0,error_number:0,error:"No errors."}}catch(e){return{valid:!1,error_number:1,error:e.message}}},e.prototype.getRENStr=function(){return this.kpgn.ren.toString()},Object.defineProperty(e.prototype,"piecesInBoardMultiArray",{get:function(){return this.kpgn.ren.board.piecesMultiArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"piecesInBoard",{get:function(){return this.kpgn.ren.board.pieces},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"piecesInGraveyard",{get:function(){return this.kpgn.ren.graveyard.pieces},enumerable:!1,configurable:!0}),e.prototype.getKPGN=function(){return this.kpgn.toJson()},e.prototype.loadKpgn=function(e,t){this.kpgn=new u.default(this.kpgn.ren)},e.prototype.drawAscii=function(){return(0,a.default)(this.kpgn.ren)},Object.defineProperty(e.prototype,"turn",{get:function(){return this.kpgn.ren.turn},set:function(e){this.kpgn.ren.turn=e},enumerable:!1,configurable:!0}),e.prototype.move=function(e,t){var n=this.kpgn.ren.move(e,t);return this.kpgn.addMove(n),n},e.prototype.clearBoard=function(){this.kpgn.ren=s.default.fromString("4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB")},e.prototype.getHistories=function(){return this.kpgn.moves},e.toKhmerNum=function(e){return(""+e).split("").map((function(e){return o.VERTICAL_NOTE_LETTERS[o.VERTICAL_NOTE_LETTERS_ENGLISH.indexOf(e)]})).join("")},e.title=i.default.name,e.version=i.default.version,e}();t.default=c},542:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(749),i=function(){function e(e,t){t||(t=(e=e[0])[1]),this.h=e,this.v=Number(t)}return Object.defineProperty(e.prototype,"x",{get:function(){return r.HORIZONTAL_CODE_LETTERS.indexOf(this.h)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.v-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indexCode",{get:function(){return""+this.h+this.v},enumerable:!1,configurable:!0}),e}();t.default=i},805:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(74)),o=r(n(921)),u=n(749),a=function(){function e(){this.piecesString="",this.currentTurn="",this.isQueenMoved=!1,this.isKingMoved=!1,this.genCanMove=!1,this.genCanMoveForAnother=!1,this.whiteMoves=[],this.blackMoves=[],this.whiteKingInDanger=null,this.whiteKingWillInDanger=null,this.blackKingInDanger=null,this.blackKingWillInDanger=null,this.winColor=null,this.stuckColor=null}return Object.defineProperty(e.prototype,"isWhiteTurn",{get:function(){return i.default.isWhiteColor(this.currentTurn)},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.piecesString=e.piecesString,this.currentTurn=e.currentTurn,this.isQueenMoved=e.isQueenMoved,this.isKingMoved=e.isKingMoved,this.genCanMove=e.genCanMove,this.genCanMoveForAnother=e.genCanMoveForAnother,this.whiteMoves=[],this.blackMoves=[],this.whiteKingInDanger=null,this.whiteKingWillInDanger=null,this.blackKingInDanger=null,this.blackKingWillInDanger=null,this.winColor=null,this.stuckColor=null},e.prototype.generateCanMoves=function(){var e=this,t=o.default.filterPieceInBoard(this.piecesString);this.whiteMoves=t.whitePieces,this.blackMoves=t.blackPieces;var n=function(t){t.forEach((function(t){var n=e.isKingMoved;if(null!==t.piece){null===t.piece||t.piece.isTypeKing||(n=!!t.piece.isTypeQueen&&e.isQueenMoved);var r=e.genCanMovePointsByPiecePoint(t.point,t.piece,e.piecesString,n);t.canMovePoints=r}}))};n(this.whiteMoves),n(this.blackMoves)},e.prototype.cleanPieceNoMove=function(){var e=function(e){for(var t=!0;t;){t=!1;for(var n=0;n<e.length;n++)if(!e[n].canMovePoints.length){e.splice(n,1),t=!0;break}}};e(this.whiteMoves),e(this.blackMoves)},e.prototype.checkIfKingInDanger=function(){this.whiteKingInDanger=o.default.getKingInDanger(u.PIECE_COLOR_WHITE,this.piecesString),this.whiteKingWillInDanger=o.default.getKingWillInDanger(u.PIECE_COLOR_WHITE,this.piecesString),this.blackKingInDanger=o.default.getKingInDanger(u.PIECE_COLOR_BLACK,this.piecesString),this.blackKingWillInDanger=o.default.getKingWillInDanger(u.PIECE_COLOR_BLACK,this.piecesString)},e.prototype.genWinLost=function(){this.whiteKingInDanger&&!this.whiteMoves.length?this.winColor=u.PIECE_COLOR_BLACK:this.blackKingInDanger&&!this.blackMoves.length&&(this.winColor=u.PIECE_COLOR_WHITE)},e.prototype.getStuck=function(){this.winColor||(this.isWhiteTurn&&!this.whiteMoves.length?this.stuckColor=u.PIECE_COLOR_WHITE:this.isWhiteTurn||this.blackMoves.length||(this.stuckColor=u.PIECE_COLOR_BLACK))},e.prototype.calcCanMove=function(e){this.init(e),this.generateCanMoves(),this.cleanPieceNoMove();var t=[];this.genCanMove&&(t=this.isWhiteTurn?this.whiteMoves:this.blackMoves);var n=[];return this.genCanMoveForAnother&&(n=this.isWhiteTurn?this.blackMoves:this.whiteMoves),{moves:t,anotherMoves:n}},e.prototype.calcState=function(e){return this.init(e),this.generateCanMoves(),this.cleanPieceNoMove(),this.checkIfKingInDanger(),this.genWinLost(),this.getStuck(),{blackKingInDanger:this.blackKingInDanger,whiteKingInDanger:this.whiteKingInDanger,blackKingWillInDanger:this.blackKingWillInDanger,whiteKingWillInDanger:this.whiteKingWillInDanger,winColor:this.winColor,stuckColor:this.stuckColor}},e.prototype.calCount=function(e){var t=e.color,n=e.piecesString,r=e.force;return o.default.checkCount(t,n,r)},e.prototype.genCanMovePointsByPiecePoint=function(e,t,n,r){return o.default.genCanMovePointsByPiecePoint(e.index,t,n,r)},e}();t.default=a},272:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(749),i=function(){function e(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r}return e.prototype.isContainsPoint=function(e){var t=e.x,n=e.y;return this.x<=t&&this.x+this.width>=t&&this.y<=n&&this.y+this.height>=n},e.isValidPoint=function(t){return new e(0,0,r.ROW_LAST_INDEX,r.ROW_LAST_INDEX).isContainsPoint(t)},e}();t.default=i},921:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CountUpState=void 0;var i=r(n(536)),o=n(749),u=r(n(16)),a=r(n(74)),s=r(n(272)),c=n(941),l=(0,i.default)(),h=function(e,t){this.countingNumber=e,this.countingToNumber=t};t.CountUpState=h;var p=function(){function e(){this.convertMask=function(e,t,n){var r=a.default.isWhiteColor(n)?1:-1,i=u.default.fromIndex(t);return e.x=e.x*r+i.x,e.y=e.y*r+i.y,s.default.isValidPoint(e)?e.index:null}}return e.prototype.getCharPieceFromString=function(e,t){return u.default.isIndexInBoard(t)&&e.length===o.CELL_COUNT?e[t]:o.EMPTY_PIECE},e.prototype.getCharPieceInPos=function(e,t){return this.getCharPieceFromString(t,e)},e.prototype.getPieceByIndex=function(e,t){var n=this.getCharPieceInPos(e,t);return{isValidPiece:a.default.isValidPiece(n),piece:a.default.fromCharCode(n)}},e.prototype.getPieceCanMovePoses=function(e,t){var n=this,r=[];return l[t.type].forEach((function(i){var o=n.convertMask(new u.default(i[0],i[1]),e,t.color);null!==o&&r.push(o)})),r},e.prototype.getPieceCanMovePosesValid=function(e,t,n){for(var r=this.getPieceCanMovePoses(e,t),i=[],o=r.length,a=u.default.fromIndex(e),s=0;s<o;s++){var c=u.default.fromIndex(r[s]),l=this.getPieceByIndex(c.index,n);if(l.isValidPiece?(l.piece&&t.color===l.piece.color||t.isTypeFish&&c.x===a.x)&&(c=null):t.isTypeFish&&c.x!==a.x&&(c=null),null!==c&&t.isTypeBoat){var h=a.x,p=a.y;if(c.x===a.x){for(var f=Math.abs(c.y-a.y),d=a.y<c.y?1:-1;--f>0;)if(this.getPieceByIndex(u.default.xyToIndex(h,p+d*f),n).isValidPiece){c=null;break}}else if(c.y===a.y)for(f=Math.abs(c.x-a.x),d=a.x<c.x?1:-1;--f>0;)if(this.getPieceByIndex(u.default.xyToIndex(h+d*f,p),n).isValidPiece){c=null;break}}null!==c&&i.push(r[s])}return i},e.prototype.replacePiecesStringAtIndex=function(e,t,n){return e.substring(0,n)+t+e.substring(n+1)},e.prototype.injectPiece=function(e,t,n){var r=e[t];return this.isCharPiecesInBoard(r,e)?(e=this.replacePiecesStringAtIndex(e,o.EMPTY_PIECE,t),e=this.replacePiecesStringAtIndex(e,r,n)):null},e.prototype.getKingWillInDanger=function(e,t){for(var n=t.indexOf(new a.default(o.PIECE_TYPE_KING,e).pieceCharCode),r=t.length,i=0;i<r;i++){var s=this.getPieceByIndex(i,t);if(null!==s.piece&&s.isValidPiece&&s.piece.color!==e&&s.piece.isTypeBoat)for(var c=this.getPieceCanMovePoses(i,s.piece),l=0;l<c.length;l++)if(c[l]===n)return[u.default.fromIndex(i),u.default.fromIndex(n)]}return null},e.prototype.getKingInDanger=function(e,t){for(var n=t.indexOf(new a.default(o.PIECE_TYPE_KING,e).pieceCharCode),r=t.length,i=0;i<r;i++){var s=this.getPieceByIndex(i,t);if(null!==s.piece&&s.isValidPiece&&s.piece.color!==e)for(var c=this.getPieceCanMovePosesValid(i,s.piece,t),l=0;l<c.length;l++)if(c[l]===n)return[u.default.fromIndex(i),u.default.fromIndex(n)]}return null},e.prototype.genCanMovePointsByPiecePoint=function(e,t,n,r){var i=this.getPieceCanMovePosesValid(e,t,n),o=this.isHaveCaptured(n);if(t.isTypeKing)o||r||((a=this.convertMask(new u.default(2,1),e,t.color))&&!this.getPieceByIndex(a,n).isValidPiece&&i.push(a),(a=this.convertMask(new u.default(-2,1),e,t.color))&&!this.getPieceByIndex(a,n).isValidPiece&&i.push(a));else if(t.isTypeQueen){var a;o||r||(a=this.convertMask(new u.default(-0,2),e,t.color))&&!this.getPieceByIndex(a,n).isValidPiece&&i.push(a)}for(var s=i.length,c=[],l=0;l<s;l++){var h=this.injectPiece(n,e,i[l]);null!==h&&null===this.getKingInDanger(t.color,h)&&c.push(u.default.fromIndex(i[l]))}return c},e.prototype.isCharPiecesInBoard=function(e,t){return!!~t.indexOf(e)},e.prototype.getPiecesInBoard=function(e){return e.split("").filter((function(e){return a.default.isValidPiece(e)}))},e.prototype.isHaveCaptured=function(e){return this.getPiecesInBoard(e).length<4*o.ROW_NUMBER},e.prototype.filterPieceInBoard=function(e){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r];if(a.default.isValidPiece(i)){var o=new c.PieceIndex(u.default.fromIndex(r),a.default.fromCharCode(i));null!==o.piece&&o.piece.isColorWhite?t.push(o):n.push(o)}}return{whitePieces:t,blackPieces:n}},e.prototype.extractPiecesToArray=function(e){var t,n=e.split(""),r=((t={})[o.PIECE_COLOR_BLACK]=[],t[o.PIECE_COLOR_WHITE]=[],t);return n.forEach((function(e){if(e!==o.EMPTY_PIECE){var t=a.default.fromCharCode(e);t&&r[t.color].push(t.type)}})),r},e.prototype.isStateCount=function(e,t){return 1===this.extractPiecesToArray(t)[e].length},e.prototype.checkCountable=function(e,t){var n=this.extractPiecesToArray(t),r=n[e],i=n[a.default.oppositeColor(e)];return r.length<=2&&i.length>=2},e.prototype.checkCount=function(e,t,n){var r,i,u=function(e,t){return e.join("").split(t).length-1},s=this.extractPiecesToArray(t),c=s[e],l=s[a.default.oppositeColor(e)];if(1===c.length&&l.length>1){if(r=l,i=o.PIECE_TYPE_FISH,!~r.indexOf(i)){var p=64,f=u(l,o.PIECE_TYPE_BOAT);f?p=f>1?8:16:u(l,o.PIECE_TYPE_GENERAL)>1?p=22:u(l,o.PIECE_TYPE_HORSE)>1?p=32:u(l,o.PIECE_TYPE_GENERAL)&&(p=44);var d=l.length;return d>4&&(d=4),new h(d,p)}return new h(0,64)}return n&&this.checkCountable(e,t)?new h(0,64):null},e.prototype.isUpgradable=function(e,t){if(e.isTypeFish){if(e.isColorBlack&&t.y<=2)return!0;if(e.isColorWhite&&t.y>=5)return!0}return!1},e}();t.default=new p},749:(e,t)=>{var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.VERTICAL_NOTE_LETTERS_ENGLISH=t.HORIZONTAL_NOTE_LETTERS_ENGLISH=t.VERTICAL_NOTE_LETTERS=t.HORIZONTAL_NOTE_LETTERS=t.HORIZONTAL_CODE_LETTERS=t.CELL_COUNT=t.ROW_LAST_INDEX=t.ROW_FIRST_INDEX=t.ROW_NUMBER=t.BOARD_SEPARATOR=t.PIECE_COLOR_EMPTY=t.EMPTY_PIECE=t.PIECE_NAMES_ENGLISH=t.PIECE_NAMES=t.PIECE_TYPE_TRANSFORM_FISH=t.PIECE_TYPE_FISH=t.PIECE_TYPE_QUEEN=t.PIECE_TYPE_KING=t.PIECE_TYPE_GENERAL=t.PIECE_TYPE_HORSE=t.PIECE_TYPE_BOAT=t.COLOR_NAMES_ENGLISH=t.COLOR_NAMES=t.PIECE_COLOR_BLACK=t.PIECE_COLOR_WHITE=void 0,t.PIECE_COLOR_WHITE="w",t.PIECE_COLOR_BLACK="b",t.COLOR_NAMES=((n={})[t.PIECE_COLOR_BLACK]="ខ្មៅ",n[t.PIECE_COLOR_WHITE]="ស",n),t.COLOR_NAMES_ENGLISH=((r={})[t.PIECE_COLOR_BLACK]="black",r[t.PIECE_COLOR_WHITE]="white",r),t.PIECE_TYPE_BOAT="b",t.PIECE_TYPE_HORSE="h",t.PIECE_TYPE_GENERAL="g",t.PIECE_TYPE_KING="k",t.PIECE_TYPE_QUEEN="q",t.PIECE_TYPE_FISH="f",t.PIECE_TYPE_TRANSFORM_FISH="t",t.PIECE_NAMES=((i={})[t.PIECE_TYPE_BOAT]="ទូក",i[t.PIECE_TYPE_HORSE]="សេះ",i[t.PIECE_TYPE_GENERAL]="គោល",i[t.PIECE_TYPE_KING]="ស្តេច",i[t.PIECE_TYPE_QUEEN]="នាង",i[t.PIECE_TYPE_FISH]="ត្រី",i[t.PIECE_TYPE_TRANSFORM_FISH]="ត្រីបក",i),t.PIECE_NAMES_ENGLISH=((o={})[t.PIECE_TYPE_BOAT]="boat",o[t.PIECE_TYPE_HORSE]="horse",o[t.PIECE_TYPE_GENERAL]="general",o[t.PIECE_TYPE_KING]="king",o[t.PIECE_TYPE_QUEEN]="queen",o[t.PIECE_TYPE_FISH]="fish",o[t.PIECE_TYPE_TRANSFORM_FISH]="transformed-fish",o),t.EMPTY_PIECE=".",t.PIECE_COLOR_EMPTY=".",t.BOARD_SEPARATOR="/",t.ROW_NUMBER=8,t.ROW_FIRST_INDEX=0,t.ROW_LAST_INDEX=7,t.CELL_COUNT=t.ROW_NUMBER*t.ROW_NUMBER,t.HORIZONTAL_CODE_LETTERS="abcdefgh",t.HORIZONTAL_NOTE_LETTERS=["ក","ខ","គ","ឃ","ង","ច","ឆ","ជ"],t.VERTICAL_NOTE_LETTERS=["០","១","២","៣","៤","៥","៦","៧","៨","៩"],t.HORIZONTAL_NOTE_LETTERS_ENGLISH="abcdefgh",t.VERTICAL_NOTE_LETTERS_ENGLISH=Array.from({length:10},(function(e,t){return""+t}))},536:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(749);t.default=function(){var e={};return e[r.PIECE_TYPE_BOAT]=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0]],e[r.PIECE_TYPE_HORSE]=[[-1,-2],[1,-2],[-2,-1],[2,-1],[-1,2],[1,2],[-2,1],[2,1]],e[r.PIECE_TYPE_QUEEN]=[[-1,-1],[1,-1],[-1,1],[1,1]],e[r.PIECE_TYPE_GENERAL]=e[r.PIECE_TYPE_QUEEN].concat([[0,1]]),e[r.PIECE_TYPE_KING]=e[r.PIECE_TYPE_GENERAL].concat([[0,-1],[1,0],[-1,0]]),e[r.PIECE_TYPE_FISH]=[[0,1],[-1,1],[1,1]],e[r.PIECE_TYPE_TRANSFORM_FISH]=e[r.PIECE_TYPE_QUEEN],e}},493:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MoveHelper=t.HVPont=t.genMask=t.boardHelper=t.Rectangle=void 0;var u=n(272);Object.defineProperty(t,"Rectangle",{enumerable:!0,get:function(){return o(u).default}});var a=n(921);Object.defineProperty(t,"boardHelper",{enumerable:!0,get:function(){return o(a).default}});var s=n(536);Object.defineProperty(t,"genMask",{enumerable:!0,get:function(){return o(s).default}});var c=n(542);Object.defineProperty(t,"HVPont",{enumerable:!0,get:function(){return o(c).default}});var l=n(805);Object.defineProperty(t,"MoveHelper",{enumerable:!0,get:function(){return o(l).default}}),i(n(749),t)},138:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KhmerChess=void 0,i(n(493),t),i(n(658),t),i(n(941),t),i(n(216),t);var u=n(463);Object.defineProperty(t,"KhmerChess",{enumerable:!0,get:function(){return o(u).default}})},507:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.khmerChessNS=t.KhmerChess=void 0;var a=n(463);Object.defineProperty(t,"KhmerChess",{enumerable:!0,get:function(){return u(a).default}}),t.khmerChessNS=o(n(138))},544:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.piece,n=e.fromBoardPoint,r=e.toGraveyardPoint;this.piece=t,this.fromBoardPoint=n,this.toGraveyardPoint=r}},141:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(984)),o=r(n(965)),u=r(n(189)),a=r(n(760)),s=r(n(472)),c=r(n(995)),l=function(){function e(e){this.event="",this.date=null,this.location="",this.players={white:new u.default({}),black:new u.default({})},this.result={last:{whiteWin:!1,blackWin:!1},white:new a.default({})},this.timer=new s.default({}),this.ren=e,this.moves=[]}return Object.defineProperty(e.prototype,"isCanMoveNext",{get:function(){var e;return(null===(e=this.latestMove)||void 0===e?void 0:e.isCanMoveNext)&&this.ren.isCanMoveNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latestMove",{get:function(){return this.moves[this.moves.length-1]||null},enumerable:!1,configurable:!0}),e.prototype.addMove=function(e){return!!e&&(this.moves.push(e),!0)},e.prototype.getMove=function(e){return this.moves[e]||null},e.prototype.loadRENStr=function(e){this.ren=i.default.fromString(e),this.latestMove&&this.ren.syncWithMove(this.latestMove)},e.prototype.loadMovesStrings=function(e){var t=this.ren;this.moves=e.reverse().map((function(e){var n=o.default.fromString(e,t);if(null===n)throw new Error("Invalid move string");return t=t.backRen(n),n})).reverse(),this.latestMove&&this.ren.syncWithMove(this.latestMove)},e.prototype.fromJson=function(e){try{var t=e.ren,n=e.moves,r=e.timer,o=e.result,c=e.players,l=e.location,h=e.date,p=e.event;return this.event=p||this.event,this.date=h?new Date(h):this.date,this.location=l||this.location,c&&(this.players={white:new u.default(c.white),black:new u.default(c.black)}),o&&(this.result={last:o.last,white:new a.default(o.white)}),this.ren=i.default.fromString(t||""),this.loadMovesStrings(n||[]),this.timer=new s.default(r||{}),!0}catch(e){return console.log(e),!1}},e.prototype.toJson=function(){var e=this.ren.toString();return this.latestMove&&(e=this.latestMove.renStr),{event:this.event,date:this.date?this.date.toString():"",location:this.location,players:{white:this.players.white.toJson(),black:this.players.black.toJson()},result:{last:{whiteWin:this.result.last.whiteWin,blackWin:this.result.last.blackWin},white:this.result.white.toJson()},timer:this.timer.toJson(),moves:this.moves.map((function(e){return e.toString()})),ren:e}},e.prototype.fromBase64=function(e){var t=JSON.parse(c.default.decode(e));return this.fromJson(t)},e.prototype.toBase64=function(){var e=JSON.stringify(this.toJson());return c.default.encode(e)},e}();t.default=l},965:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(493),o=n(941),u=n(395),a=r(n(74)),s=r(n(16)),c=r(n(544)),l=function(){function e(e){var t=e.piece,n=e.moveFrom,r=e.moveTo,u=e.isUpgrading,a=e.captured;this.renStr=null,this.boardStatus={attacker:null,winColor:null,stuckColor:null,drawCountColor:null},this.isStartCounting=!1,this.piece=t,this.moveFrom=n,this.moveTo=r,this.isUpgrading=!!u,this.captured=a||null,i.boardHelper.isUpgradable(t,r)&&(this.isUpgrading=!0,t.upgrade()),this.kqJumping=new o.KqJumped}return e.prototype.setRen=function(e){e.checkBoardStatus(this),e.kqJumped.checkKQMoved(this),e.checkCountStatus(this)},e.prototype.syncRen=function(e){this.renStr=e.toString()},Object.defineProperty(e.prototype,"isCanMoveNext",{get:function(){return!(this.boardStatus.drawCountColor||this.boardStatus.winColor||this.boardStatus.stuckColor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWhiteKingJumping",{get:function(){return!!this.kqJumping.whiteKing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWhiteQueenJumping",{get:function(){return!!this.kqJumping.whiteQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackKingJumping",{get:function(){return!!this.kqJumping.blackKing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackQueenJumping",{get:function(){return!!this.kqJumping.blackQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attacker",{get:function(){return this.boardStatus.attacker||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"winColor",{get:function(){return this.boardStatus.winColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stuckColor",{get:function(){return this.boardStatus.stuckColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawCountColor",{get:function(){return this.boardStatus.drawCountColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDraw",{get:function(){return this.stuckColor||this.drawCountColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGameOver",{get:function(){return this.winColor||this.isDraw},enumerable:!1,configurable:!0}),e.fromString=function(t,n){var r=a.default.fromCharCode(t[0]);if(null===r)return null;var i=s.default.fromIndexCode(t.substr(1,2)),l=s.default.fromIndexCode(t.substr(3,2)),h=new e({piece:r,moveFrom:i,moveTo:l}),p=t.indexOf(u.PIECE_FLAG_KILL);if(~p){if(null===(E=t.substr(p+1).match(/^(\d+)/)))return null;var f=Number(E[1]),d=n.graveyard.get(f);if(!d)throw new Error("Invalid captured index");h.captured=new c.default({fromBoardPoint:l,toGraveyardPoint:s.default.fromIndexGraveyardIndex(f),piece:d})}var g=t.indexOf(u.PIECE_FLAG_JUMP);if(~g){var E;if(null===(E=t.substr(g+1).match(/^(\d+)/)))return null;var _=Number(E[1]);h.kqJumping=o.KqJumped.fromNumber(_)}return~t.indexOf(u.PIECE_FLAG_START_COUNTING)&&(h.isStartCounting=!0),h.setRen(n),h},e.prototype.toString=function(){var e=this.piece.pieceCharCode,t=this.moveFrom.indexCode,n=this.moveTo.indexCode,r="";return this.captured&&(r+=u.PIECE_FLAG_KILL+this.captured.toGraveyardPoint.index),this.kqJumping.isJumped&&(r+=u.PIECE_FLAG_JUMP+this.kqJumping.toNumber()),this.isUpgrading&&(r+=u.PIECE_FLAG_UPGRADE),this.isStartCounting&&(r+=u.PIECE_FLAG_START_COUNTING),""+e+t+n+r},e.prototype.getJumpingMessage=function(e){var t="";return e?(this.isWhiteKingJumping&&(t+=" white king jumping"),this.isWhiteQueenJumping&&(t+=" white queen jumping"),this.isBlackKingJumping&&(t+=" black king jumping"),this.isBlackQueenJumping&&(t+=" black queen jumping")):(this.isWhiteKingJumping&&(t+=" ស្តេច​ស​ភ្លោះ"),this.isWhiteQueenJumping&&(t+=" នាង​ស​ភ្លោះ"),this.isBlackKingJumping&&(t+=" ស្តេច​ខ្មៅ​ភ្លោះ"),this.isBlackQueenJumping&&(t+=" នាង​ខ្មៅ​ភ្លោះ")),t},e.prototype.getMessage=function(e){if(e){var t="";this.captured&&(t=" captures "+this.captured.piece.titleEnglish);var n=this.isUpgrading?" transforms":"",r=this.getJumpingMessage(e);return"["+this.toString()+"] "+this.piece.titleEnglish+" moved from "+this.moveFrom.titleEnglish+" to "+this.moveTo.titleEnglish+n+t+" "+r}return t="",this.captured&&(t=" ស៊ី"+this.captured.piece.title),n=this.isUpgrading?" បក":"",r=this.getJumpingMessage(e),"["+this.toString()+"] "+this.piece.title+" ដើរ​ពី "+this.moveFrom.title+" ទៅ "+this.moveTo.title+n+t+" "+r},e}();t.default=l},189:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.id,n=e.name;this.id=t||"",this.name=n||""}return e.prototype.toJson=function(){return{id:this.id,name:this.name}},e}();t.default=n},760:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.win,n=e.draw,r=e.lost;this.win=t||0,this.draw=n||0,this.lost=r||0}return e.prototype.toJson=function(){return{win:this.win,draw:this.draw,lost:this.lost}},e}();t.default=n},472:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.totalSecond,n=e.bonusTime,r=e.currentWhite,i=e.currentBlack;this.bonusTime=n||0,this.totalSecond=t||0,this.currentWhite=r||0,this.currentBlack=i||0}return e.prototype.toJson=function(){return{totalSecond:this.totalSecond,bonusTime:this.bonusTime,currentWhite:this.currentWhite,currentBlack:this.currentBlack}},e}();t.default=n},658:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.Result=t.Player=t.Captured=t.Move=t.KPGN=void 0;var i=n(141);Object.defineProperty(t,"KPGN",{enumerable:!0,get:function(){return r(i).default}});var o=n(965);Object.defineProperty(t,"Move",{enumerable:!0,get:function(){return r(o).default}});var u=n(544);Object.defineProperty(t,"Captured",{enumerable:!0,get:function(){return r(u).default}});var a=n(189);Object.defineProperty(t,"Player",{enumerable:!0,get:function(){return r(a).default}});var s=n(760);Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return r(s).default}});var c=n(472);Object.defineProperty(t,"Timer",{enumerable:!0,get:function(){return r(c).default}})},7:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._onEventListeners={},this._propEvent=[],this._isLockProp=!1,this._onEventListeners={},this._propEvent=[],this.events=e.events}return e.prototype.destroy=function(){this._onEventListeners={},this._propEvent=[]},e.prototype._checkPropEvent=function(){if(!this._isLockProp)for(;this._propEvent.length;){var e=this._propEvent.shift();this._checkOnEvent(e.name,e.data)}},e.prototype._addPropEvent=function(e,t){this._propEvent.push({name:e,data:t}),this._checkPropEvent()},e.prototype._guardEventName=function(e){if(!e)throw new Error("invalid event name")},e.prototype._checkOnEvent=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[],this._onEventListeners[e].forEach((function(e){e(t)}))},e.prototype._addOnEventListener=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[],this._onEventListeners[e].push(t)},e.prototype._removeOnEventListener=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[];var n=this._onEventListeners[e].indexOf(t);~n&&this._onEventListeners[e].splice(n,1)},e}();t.default=n},995:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,i,o,u,a,s,c="",l=0;for(e=n._utf8_encode(e);l<e.length;)o=(t=e.charCodeAt(l++))>>2,u=(3&t)<<4|(r=e.charCodeAt(l++))>>4,a=(15&r)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(r)?a=s=64:isNaN(i)&&(s=64),c=c+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return c},decode:function(e){var t,r,i,o,u,a,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(o=this._keyStr.indexOf(e.charAt(c++)))>>4,r=(15&o)<<4|(u=this._keyStr.indexOf(e.charAt(c++)))>>2,i=(3&u)<<6|(a=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(t),64!=u&&(s+=String.fromCharCode(r)),64!=a&&(s+=String.fromCharCode(i));return n._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){var t,n,r="",i=0,o=0;for(t=n=o=0;i<e.length;)(t=e.charCodeAt(i))<128?(r+=String.fromCharCode(t),i++):t>191&&t<224?(n=e.charCodeAt(i+1),r+=String.fromCharCode((31&t)<<6|63&n),i+=2):(n=e.charCodeAt(i+1),o=e.charCodeAt(i+2),r+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&o),i+=3);return r}};t.default=n},216:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.table=t.EventHandler=void 0;var i=n(7);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return r(i).default}});var o=n(870);Object.defineProperty(t,"table",{enumerable:!0,get:function(){return r(o).default}})},870:function(e,t){var n=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};function r(e){return e.map((function(e){return" "+(null===e?" ":e.pieceCharCode)+" "})).join("┃")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.board.piecesMultiArray;return n([],t,!0).reverse().reduce((function(e,n,i){return e+"\n"+(8-i)+" ┃"+r(n)+"┃\n  "+(i===t.length-1?"┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛":"┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫")}),"  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓")+"\n    a   b   c   d   e   f   g   h\n  ┏"+e.graveyard.pieces.map((function(){return"━━━"})).join("┳")+"┓\n  ┃"+r(e.graveyard.pieces)+"┃\n  ┗"+e.graveyard.pieces.map((function(){return"━━━"})).join("┻")+"┛"}},180:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(74)),o=r(n(828)),u=n(395),a=n(749),s=r(n(16)),c=function(){function e(e){this.pieceIndices=Array.from({length:a.CELL_COUNT},(function(e,t){var n=s.default.fromIndex(t);return new o.default(n,null)})),e||(e=u.DEFAULT_BOARD_STR);var t=this.extract(e).replace(/\//g,"");if(t.length<a.CELL_COUNT||!i.default.isValidPiecesString(t))throw new Error("Invalid board string "+e);this.pieceIndices=t.split("").map((function(e,t){var n=s.default.fromIndex(t);return new o.default(n,e===a.EMPTY_PIECE?null:i.default.fromCharCode(e))}))}return Object.defineProperty(e.prototype,"piecesMultiArray",{get:function(){var e=[[],[],[],[],[],[],[],[]];return this.pieceIndices.forEach((function(t){e[t.point.y][t.point.x]=t.piece})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieces",{get:function(){return this.pieceIndices.map((function(e){return e.piece}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"whiteKing",{get:function(){return this.pieceIndices.find((function(e){return e.piece&&e.piece.isTypeKing&&e.piece.isColorWhite}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blackKing",{get:function(){return this.pieceIndices.find((function(e){return e.piece&&e.piece.isTypeKing&&e.piece.isColorBlack}))},enumerable:!1,configurable:!0}),e.prototype.getKing=function(e){return i.default.isWhiteColor(e)?this.whiteKing:this.blackKing},e.prototype.compress=function(e){var t=new RegExp("(\\"+a.EMPTY_PIECE+"+)","g");return e.replace(t,(function(e){return e.length}))},e.prototype.extract=function(e){return e.replace(/(\d+)/g,(function(e){return Array.from({length:e},(function(){return a.EMPTY_PIECE})).join("")}))},e.prototype.toStringFull=function(e){return void 0===e&&(e=this.pieceIndices),e.map((function(e,t){var n=e.toPieceCharCode();return t&&t%a.ROW_NUMBER==0&&t!==a.CELL_COUNT?""+a.BOARD_SEPARATOR+n:n})).join("")},e.prototype.toStringFullNoSeparate=function(){var e=this.toStringFull();return e.replace(/\//g,"")},e.prototype.toString=function(e){var t=this.toStringFull(e);return this.compress(t)},e.prototype.getPieceAtIndex=function(e){return this.pieceIndices[e].piece},e.prototype.setPieceAtIndex=function(e,t){this.pieceIndices[e].piece=t},e}();t.default=c},65:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(493),i=n(395),o=function(){function e(){this.countingToNumber=null,this.countingNumber=null,this.isCountingUp=!1,this.color=null}return Object.defineProperty(e.prototype,"isWhite",{get:function(){return this.color===r.PIECE_COLOR_WHITE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlack",{get:function(){return this.color===r.PIECE_COLOR_BLACK},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWhiteCounting",{get:function(){return this.isCounting&&this.isWhite},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackCounting",{get:function(){return this.isCounting&&!this.isWhite},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCounting",{get:function(){return null!==this.countingToNumber},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCountingOut",{get:function(){return!(!this.isCounting||null===this.countingNumber||null===this.countingToNumber)&&this.countingNumber>=this.countingToNumber},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t,n){this.color=e,this.countingToNumber=t,this.countingNumber=n},e.prototype.clear=function(){this.color=null,this.countingToNumber=null,this.countingNumber=null},e.prototype.checkUp=function(e){null!==this.countingNumber&&e===this.color?(this.countingNumber++,this.isCountingUp=!0):this.isCountingUp=!1},e.fromString=function(t){t||(t=i.NOT_SET+"."+i.NOT_SET+"@"+i.NOT_SET);var n=new e,o=t.split("@");o[1]!==i.NOT_SET&&(n.countingToNumber=Number(o[1]));var u=o[0].split(".");return u[0]!==i.NOT_SET&&(n.color=r.PIECE_COLOR_WHITE,n.countingNumber=Number(u[0])),u[1]!==i.NOT_SET&&(n.color=r.PIECE_COLOR_BLACK,n.countingNumber=Number(u[1])),n},e.prototype.toString=function(){var e=""+(this.isCounting&&this.isWhite?this.countingNumber:i.NOT_SET);return(e+="."+(this.isCounting&&!this.isWhite?this.countingNumber:i.NOT_SET))+"@"+(this.isCounting?this.countingToNumber:i.NOT_SET)},e}();t.default=o},814:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(74)),o=function(){function e(e){if(this.pieces=[],e){if(e.length>30||!i.default.isValidPiecesString(e,!0))throw new Error("Invalid graveyard string "+e);this.pieces=e.split("").map((function(e,t){return i.default.fromCharCode(e)})).filter((function(e){return null!==e}))}}return Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.pieces.length-1},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this.pieces[e]},e.prototype.removeAtIndex=function(e){return this.get(e)&&this.pieces.splice(e,1),!0},e.prototype.toString=function(){return this.pieces.map((function(e){return e.pieceCharCode})).join("")},e}();t.default=o},685:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(749),o=n(395),u=r(n(74)),a=function(){function e(e){this.whiteKing=!1,this.blackKing=!1,e&&(this.whiteKing=!!~e.indexOf(u.default.toWhiteCharCode(i.PIECE_TYPE_KING)),this.blackKing=!!~e.indexOf(i.PIECE_TYPE_KING))}return e.prototype.toString=function(){return""+(this.whiteKing?u.default.toWhiteCharCode(i.PIECE_TYPE_KING):o.NOT_SET)+""+(this.blackKing?i.PIECE_TYPE_KING:o.NOT_SET)},e}();t.default=a},721:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(749),o=n(395),u=r(n(74)),a=function(){function e(e){var t;this.whiteKing=!1,this.whiteQueen=!1,this.blackKing=!1,this.blackQueen=!1,this.keyCodes={blackKing:u.default.toWhiteCharCode(i.PIECE_TYPE_QUEEN),whiteKing:u.default.toWhiteCharCode(i.PIECE_TYPE_KING),whiteQueen:i.PIECE_TYPE_KING,blackQueen:i.PIECE_TYPE_QUEEN},this.codeKeys=((t={})[u.default.toWhiteCharCode(i.PIECE_TYPE_QUEEN)]="blackKing: ",t[u.default.toWhiteCharCode(i.PIECE_TYPE_KING)]="whiteKing: ",t[i.PIECE_TYPE_KING]="whiteQueen: ",t[i.PIECE_TYPE_QUEEN]="blackQueen: ",t),e&&(this.whiteKing=!!~e.indexOf(u.default.toWhiteCharCode(i.PIECE_TYPE_KING)),this.whiteQueen=!!~e.indexOf(u.default.toWhiteCharCode(i.PIECE_TYPE_QUEEN)),this.blackKing=!!~e.indexOf(i.PIECE_TYPE_KING),this.blackQueen=!!~e.indexOf(i.PIECE_TYPE_QUEEN))}return Object.defineProperty(e.prototype,"isJumped",{get:function(){return this.whiteKing||this.whiteQueen||this.blackKing||this.blackQueen},enumerable:!1,configurable:!0}),e.prototype.setProp=function(e,t){this[e]=t},e.prototype.applyJumping=function(e,t){this[e]||(t.kqJumping.setProp(e,!0),this.setProp(e,!0))},e.prototype.checkKQMoved=function(e){(e.attacker||e.captured)&&(this.applyJumping("whiteKing",e),this.applyJumping("blackKing",e),this.applyJumping("whiteQueen",e),this.applyJumping("blackQueen",e));var t=e.piece;t.isTypeKing?t.isColorWhite?this.applyJumping("whiteKing",e):this.applyJumping("blackKing",e):t.isTypeQueen&&(t.isColorWhite?this.applyJumping("whiteQueen",e):this.applyJumping("blackQueen",e))},e.prototype.toString=function(){var e=""+(this.whiteKing?u.default.toWhiteCharCode(i.PIECE_TYPE_KING):o.NOT_SET);return e+=""+(this.whiteQueen?u.default.toWhiteCharCode(i.PIECE_TYPE_QUEEN):o.NOT_SET),(e+=""+(this.blackKing?i.PIECE_TYPE_KING:o.NOT_SET))+""+(this.blackQueen?i.PIECE_TYPE_QUEEN:o.NOT_SET)},e.prototype.toNumber=function(){var e=""+(this.whiteKing?1:0);return e+=""+(this.whiteQueen?1:0),e+=""+(this.blackKing?1:0),e+=""+(this.blackQueen?1:0),parseInt(e,2)},e.fromNumber=function(t){var n=("0000"+Number(t).toString(2)).substr(-4),r=new e;return r.whiteKing="1"===n[0],r.whiteQueen="1"===n[1],r.blackKing="1"===n[2],r.blackQueen="1"===n[3],r},e}();t.default=a},74:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(749),o=function(){function e(t,n){this.type=e.toNormalCharCode(t),this.color=n}return Object.defineProperty(e.prototype,"colorOpponent",{get:function(){return e.oppositeColor(this.color)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieceCharCode",{get:function(){return this.isColorWhite?this.pieceCharCodeWhite:this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieceCharCodeWhite",{get:function(){return e.toWhiteCharCode(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return""+i.PIECE_NAMES[this.type]+i.COLOR_NAMES[this.color]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"titleEnglish",{get:function(){return i.COLOR_NAMES_ENGLISH[this.color]+"-"+i.PIECE_NAMES_ENGLISH[this.type]},enumerable:!1,configurable:!0}),e.prototype._isTypeEqual=function(e){return this.type===e},Object.defineProperty(e.prototype,"isTypeKing",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_KING)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeQueen",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_QUEEN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeBoat",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_BOAT)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeHorse",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_HORSE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeGeneral",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_GENERAL)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeFish",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_FISH)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeTransformedFish",{get:function(){return this._isTypeEqual(i.PIECE_TYPE_TRANSFORM_FISH)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isColorBlack",{get:function(){return e.isBlackColor(this.color)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isColorWhite",{get:function(){return e.isWhiteColor(this.color)},enumerable:!1,configurable:!0}),e.fromCharCode=function(t){if(!e.isValidPiece(t))return null;var n=e.isWhiteCharCode(t)?i.PIECE_COLOR_WHITE:i.PIECE_COLOR_BLACK,r=e.toNormalCharCode(t);return new e(r,n)},Object.defineProperty(e.prototype,"originPiece",{get:function(){return this.isTypeTransformedFish?new e(i.PIECE_TYPE_FISH,this.color):this},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pieceChars",{get:function(){return[i.PIECE_TYPE_BOAT,i.PIECE_TYPE_HORSE,i.PIECE_TYPE_GENERAL,i.PIECE_TYPE_KING,i.PIECE_TYPE_QUEEN,i.PIECE_TYPE_FISH,i.PIECE_TYPE_TRANSFORM_FISH]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"colorChars",{get:function(){return[i.PIECE_COLOR_WHITE,i.PIECE_COLOR_BLACK]},enumerable:!1,configurable:!0}),e.toWhiteCharCode=function(e){return e.toUpperCase()},e.isWhiteCharCode=function(e){return e===e.toUpperCase()},e.toBlackCharCode=function(e){return e.toLowerCase()},e.toNormalCharCode=function(t){return e.toBlackCharCode(t)},e.isValidPiece=function(e){return e!==i.EMPTY_PIECE},e.isWhiteColor=function(e){return e===i.PIECE_COLOR_WHITE},e.isBlackColor=function(e){return e===i.PIECE_COLOR_BLACK},e.oppositeColor=function(t){return e.isWhiteColor(t)?i.PIECE_COLOR_BLACK:i.PIECE_COLOR_WHITE},e.isValidPiecesString=function(e,t){var n=t?u.filter((function(e){return!~[i.EMPTY_PIECE,i.BOARD_SEPARATOR].indexOf(e)})):u;return!e.split("").some((function(e){return!~n.indexOf(e)}))},e.prototype.upgrade=function(){return!!this.isTypeFish&&(this.type=i.PIECE_TYPE_TRANSFORM_FISH,!0)},e.prototype.downgrade=function(){return!!this.isTypeTransformedFish&&(this.type=i.PIECE_TYPE_FISH,!0)},e.prototype.clone=function(){return e.fromCharCode(this.pieceCharCode)},e}();t.default=o;var u=r(r(r([],o.pieceChars,!0),o.pieceChars.map((function(e){return o.toWhiteCharCode(e)})),!0),[i.EMPTY_PIECE,i.BOARD_SEPARATOR],!1)},828:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(749),i=function(){function e(e,t){this.canMovePoints=[],this.point=e,this.piece=t}return e.prototype.toCode=function(){return null===this.piece?null:""+this.piece.pieceCharCode+this.point.indexCode},e.prototype.toPieceCharCode=function(){return null===this.piece?r.EMPTY_PIECE:this.piece.pieceCharCode},e}();t.default=i},16:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(749),i=function(){function e(e,t){this.x=e,this.y=t}return Object.defineProperty(e.prototype,"index",{get:function(){return e.xyToIndex(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"graveyardIndex",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indexCode",{get:function(){return""+this.h+this.v},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return""+r.HORIZONTAL_NOTE_LETTERS[this.x]+r.VERTICAL_NOTE_LETTERS[this.y]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"titleEnglish",{get:function(){return this.indexCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"h",{get:function(){return r.HORIZONTAL_CODE_LETTERS[this.x]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"v",{get:function(){return this.y+1},enumerable:!1,configurable:!0}),e.xyToIndex=function(e,t){return t*r.ROW_NUMBER+e},e.indexCodeToXY=function(e){return{x:r.HORIZONTAL_CODE_LETTERS.indexOf(e[0]),y:Number(e[1])-1}},e.indexCodeToIndex=function(t){var n=e.indexCodeToXY(t),r=n.x,i=n.y;return e.xyToIndex(r,i)},e.fromIndexCode=function(t){var n=e.indexCodeToXY(t);return new e(n.x,n.y)},e.indexToXY=function(e){return{x:e%r.ROW_NUMBER,y:Math.floor(e/r.ROW_NUMBER)}},e.fromIndex=function(t){var n=e.indexToXY(t);return new e(n.x,n.y)},e.fromIndexGraveyardIndex=function(t){return new e(t,0)},e.isIndexInBoard=function(e){return e>=0&&e<=r.CELL_COUNT-1},e}();t.default=i},984:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(180)),o=r(n(721)),u=r(n(685)),a=r(n(65)),s=r(n(814)),c=n(395),l=n(658),h=r(n(965)),p=r(n(16)),f=r(n(74)),d=n(941),g=r(n(805)),E=n(749),_=function(){function e(e){this.moveHelper=new g.default;var t=e.boardStr,n=e.turnStr,r=e.kqJumpedStr,c=e.kAttackedStr,l=e.countUpStr,h=e.graveyardStr;this.board=new i.default(t),this.turn=n||E.PIECE_COLOR_WHITE,this.kqJumped=new o.default(r),this.kAttacked=new u.default(c),this.countUp=a.default.fromString(l),this.graveyard=new s.default(h);var p=this.isInvalidPieceCount();if(p){var f="Invalid piece string board:"+t;throw new Error(f+=", graveyard:"+h+", count:"+p)}this.moveHelper=new g.default}return e.prototype.isInvalidPieceCount=function(){var e=this.board.pieceIndices.map((function(e){return e.piece})).filter((function(e){return null!==e})).concat(this.graveyard.pieces).map((function(e){return e.originPiece})).reduce((function(e,t){return e[t.pieceCharCode]=e[t.pieceCharCode]||0,e[t.pieceCharCode]++,e}),{}),t=Object.keys(e).map((function(t){return""+t+e[t]})).sort().join("");return t!==c.STRING_COUNT&&t},e.prototype.backRen=function(t){var n=e.fromString(this.toString());return n.moveBack(t),n},Object.defineProperty(e.prototype,"isCanMoveNext",{get:function(){return!this.countUp.isCountingOut},enumerable:!1,configurable:!0}),e.prototype.move=function(e,t){if(!this.isCanMoveNext)return null;var n=this.board.getPieceAtIndex(e);if(!n)return null;this.board.setPieceAtIndex(e,null);var r=new h.default({moveFrom:p.default.fromIndex(e),moveTo:p.default.fromIndex(t),piece:n.clone()});r.isUpgrading&&n.upgrade();var i=this.board.getPieceAtIndex(t);return i&&(this.graveyard.pieces.push(i),r.captured=new l.Captured({fromBoardPoint:p.default.fromIndex(t),toGraveyardPoint:p.default.fromIndex(this.graveyard.lastIndex),piece:i})),this.board.setPieceAtIndex(t,n),this.turn=f.default.oppositeColor(n.color),r.setRen(this),r},e.prototype.moveBack=function(e){var t=e.moveTo.index,n=e.moveFrom.index,r=this.board.getPieceAtIndex(t);if(this.board.setPieceAtIndex(t,null),!r)return!1;if(this.board.setPieceAtIndex(n,r),e.captured){var i=e.captured.toGraveyardPoint.index,o=this.graveyard.get(i);this.board.setPieceAtIndex(t,o),this.graveyard.removeAtIndex(i)}return e.kqJumping.whiteKing&&(this.kqJumped.whiteKing=!1),e.kqJumping.whiteQueen&&(this.kqJumped.whiteQueen=!1),e.kqJumping.blackKing&&(this.kqJumped.blackKing=!1),e.kqJumping.blackQueen&&(this.kqJumped.blackQueen=!1),this.countUp&&this.countUp.clear(),this.turn=r.color,!0},e.fromString=function(t){t||(t=c.DEFAULT_BOARD_STR);var n=t.split(" ");return new e({boardStr:n[0],turnStr:n[1],kqJumpedStr:n[2],kAttackedStr:n[3],countUpStr:n[4],graveyardStr:n[5]})},e.prototype.toString=function(){var e=this.board.toString();return e+=" "+this.turn.toString(),e+=" "+this.kqJumped.toString(),e+=" "+this.kAttacked.toString(),(e+=" "+this.countUp.toString())+" "+this.graveyard.toString()},Object.defineProperty(e.prototype,"isQueenMoved",{get:function(){return f.default.isWhiteColor(this.turn)&&this.kqJumped.whiteQueen||f.default.isBlackColor(this.turn)&&this.kqJumped.blackQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isKingMoved",{get:function(){return f.default.isWhiteColor(this.turn)&&this.kqJumped.whiteKing||f.default.isBlackColor(this.turn)&&this.kqJumped.blackKing},enumerable:!1,configurable:!0}),e.prototype.genAllCanMoves=function(){return this.moveHelper.calcCanMove({piecesString:this.board.toStringFullNoSeparate(),currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!0,genCanMoveForAnother:!1}).moves},e.prototype.isHasMoved=function(e){var t=!1;return(this.kqJumped.blackKing&&e.isColorBlack&&e.isTypeKing||this.kqJumped.whiteKing&&e.isColorWhite&&e.isTypeKing||this.kqJumped.blackQueen&&e.isColorBlack&&e.isTypeQueen||this.kqJumped.whiteQueen&&e.isColorWhite&&e.isTypeQueen)&&(t=!0),t},e.prototype.getCanMovePointsByPoint=function(e){var t=this.board.getPieceAtIndex(e.index);return null===t?[]:this.moveHelper.genCanMovePointsByPiecePoint(e,t,this.board.toStringFullNoSeparate(),this.isHasMoved(t))},e.prototype.checkBoardStatus=function(e,t){var n=this,r=this.board.toStringFullNoSeparate(),i=this.moveHelper.calcState({piecesString:r,currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!1,genCanMoveForAnother:!1}),o=i.blackKingInDanger||i.whiteKingInDanger;if(o){var u=o.map((function(e){return new d.PieceIndex(e,n.board.getPieceAtIndex(e.index))})).filter((function(e){return null!==e.piece&&!e.piece.isTypeKing}))[0];e.boardStatus.attacker=u}e.boardStatus.winColor=i.winColor,e.boardStatus.stuckColor=i.stuckColor},e.prototype.checkCountStatus=function(e,t){if(e.isCanMoveNext){var n=this.board.toStringFullNoSeparate();if(this.countUp.isCounting)e.isStartCounting=!1,this.countUp.checkUp(e.piece.color),this.countUp.isCountingOut&&(e.boardStatus.drawCountColor=this.countUp.color);else{var r=f.default.oppositeColor(e.piece.color),i=this.moveHelper.calCount({color:f.default.oppositeColor(e.piece.color),piecesString:n,force:!!t});i&&(this.countUp.set(r,i.countingToNumber,i.countingNumber),e.isStartCounting=!0)}}e.syncRen(this)},e.prototype.getWinColor=function(){return this.moveHelper.calcState({piecesString:this.board.toStringFullNoSeparate(),currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!1,genCanMoveForAnother:!1}).winColor},e.prototype.syncWithMove=function(e){if(e){var t=this.countUp;t.isCounting&&this.turn!==t.color&&!e.isStartCounting&&(t.isCountingUp=!0)}},e}();t.default=_},395:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_FLAG_MOVING=t.EVENT_FLAG_COUNT_UP_OUT=t.EVENT_FLAG_COUNTING_UP=t.EVENT_FLAG_START_COUNTING=t.EVENT_FLAG_DRAW=t.EVENT_FLAG_WIN=t.EVENT_FLAG_ATTACK=t.PIECE_FLAG_START_COUNTING=t.PIECE_FLAG_UPGRADE=t.PIECE_FLAG_JUMP=t.PIECE_FLAG_KILL=t.NOT_SET=t.DEFAULT_BOARD_STR=t.STRING_COUNT=void 0,t.STRING_COUNT="B2F8G2H2K1Q1b2f8g2h2k1q1",t.DEFAULT_BOARD_STR="BHGKQGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgqkghb",t.NOT_SET="-",t.PIECE_FLAG_KILL="<",t.PIECE_FLAG_JUMP="^",t.PIECE_FLAG_UPGRADE="*",t.PIECE_FLAG_START_COUNTING="#",t.EVENT_FLAG_ATTACK="attack",t.EVENT_FLAG_WIN="win",t.EVENT_FLAG_DRAW="draw",t.EVENT_FLAG_START_COUNTING="start-counting",t.EVENT_FLAG_COUNTING_UP="counting-up",t.EVENT_FLAG_COUNT_UP_OUT="count-up-out",t.EVENT_FLAG_MOVING="moving"},941:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Point=t.REN=t.PieceIndex=t.Piece=t.KqJumped=t.KAttacked=t.Graveyard=t.CountUp=t.Board=void 0;var u=n(180);Object.defineProperty(t,"Board",{enumerable:!0,get:function(){return o(u).default}});var a=n(65);Object.defineProperty(t,"CountUp",{enumerable:!0,get:function(){return o(a).default}});var s=n(814);Object.defineProperty(t,"Graveyard",{enumerable:!0,get:function(){return o(s).default}});var c=n(685);Object.defineProperty(t,"KAttacked",{enumerable:!0,get:function(){return o(c).default}});var l=n(721);Object.defineProperty(t,"KqJumped",{enumerable:!0,get:function(){return o(l).default}});var h=n(74);Object.defineProperty(t,"Piece",{enumerable:!0,get:function(){return o(h).default}});var p=n(828);Object.defineProperty(t,"PieceIndex",{enumerable:!0,get:function(){return o(p).default}});var f=n(984);Object.defineProperty(t,"REN",{enumerable:!0,get:function(){return o(f).default}});var d=n(16);Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return o(d).default}}),i(n(395),t)},147:e=>{e.exports=JSON.parse('{"name":"khmer-chess","version":"1.0.65","description":"KhmerChess Javascript library","main":"dist/src/index.js","types":"src/index.ts","scripts":{"start":"ts-node test-index.ts","start:watch":"nodemon --watch \'**/*\' -e ts --exec \'npm start\'","lint":"eslint . --ext .ts ./src","build:bundle":"webpack --config webpack.config.js","build:js":"del-cli dist -f && npm run lint && tsc","build":"npm run build:js && npm run build:bundle","test":"karma start karma.conf.js","cov":"http-server coverage/ -o","pub":"npm i && npm run build && npm publish"},"repository":{"type":"git","url":"git+https://github.com/K4us/khmer-chess.js.git"},"keywords":["KhmerChess","Khmer","Chess","Node.js","Library"],"author":"Raksa Eng <eng.raksa@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/K4us/khmer-chess.js/issues"},"homepage":"https://github.com/K4us/khmer-chess.js#readme","devDependencies":{"@types/jasmine":"^3.8.2","@typescript-eslint/eslint-plugin":"^4.15.1","@typescript-eslint/parser":"^4.15.1","del-cli":"^4.0.1","eslint":"^7.20.0","http-server":"^13.0.1","karma":"^6.3.4","karma-chrome-launcher":"^3.1.0","karma-jasmine":"^4.0.1","karma-typescript":"^5.5.2","nodemon":"^2.0.20","ts-node":"^9.1.1","typescript":"^4.3.5","webpack":"^5.21.2","webpack-cli":"^4.5.0"}}')}},t={};return function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(507)})()}));
//# sourceMappingURL=khmer-chess.umd.js.map